(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{156:function(e,t,n){e.exports=n(305)},305:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(5),o=n.n(i),c=n(105),l=n.n(c),s=n(140),u=n(76),h=n(57),d=n(153),f=n(141),p=n(154),m=(n(162),n(106)),k=n(152);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var b=function(){function e(){Object(u.a)(this,e),this._files=[],this.bucketRoot={name:"",key:"",type:"bucket",share:"".concat(this.url),size:0,children:[]},this.bucketUrl="".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.port?":"+window.location.port:""),this.url="".concat(this.bucketUrl).concat(window.location.pathname),console.log("currentScript)",document.currentScript),document.currentScript,window.location.search&&(this.params=window.location.search.slice(1).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){var n=Object(k.a)(t,2),a=n[0],r=n[1];return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach(function(t){Object(m.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},e,Object(m.a)({},a,r))},{}),"shared"in this.params&&(this.shared=this.params.shared)),this.getContentes()}return Object(h.a)(e,[{key:"tree",get:function(){return this.bucketRoot.children}},{key:"root",get:function(){return this.bucketRoot}},{key:"files",get:function(){return this._files}},{key:"name",get:function(){return this.bucketName}}]),Object(h.a)(e,[{key:"parseContents",value:function(e){var t={key:this.getNodeValue("Key",e),modified:this.getNodeValue("LastModified",e),size:parseInt(this.getNodeValue("Size",e)),type:"file"};return t.name=t.key.split("/").pop(),t.extension=t.name.split(".").pop(),t.url="".concat(this.bucketUrl,"/").concat(t.key),t.share=t.url,t}},{key:"addTreeNode",value:function(e){var t=e.key.split("/");t.pop();for(var n=this.bucketRoot;0!==t.length;){var a=t.shift(),r=n.children.find(function(e){return e.name===a});r||((r={name:a,type:"folder",size:0,key:"".concat(n.key).concat(a,"/"),children:[]}).share="".concat(this.url,"?shared=").concat(r.key),n.children.push(r),n.children.sort(this.sorter)),r.size+=e.size,n=r}n.children.push(e),n.children.sort(this.sorter),this.bucketRoot.size+=e.size}},{key:"getNodeValue",value:function(e,t){return t.getElementsByTagName(e)[0].childNodes[0].nodeValue}},{key:"sorter",value:function(e,t){return e.type===t.type?e.name.localeCompare(t.name):"folder"===e.type?-1:1}},{key:"fetchBucketData",value:function(e){var t=this.bucketUrl;e&&(t="".concat(this.bucketUrl,"/?marker=").concat(e));var n=new XMLHttpRequest;if(n.open("GET",t,!1),n.send(null),200===n.status)return(new window.DOMParser).parseFromString(n.responseText,"text/xml")}},{key:"getFilesFromXML",value:function(e){var t=e.getElementsByTagName("Contents"),n=!0,a=!1,r=void 0;try{for(var i,o=t[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,l=this.parseContents(c);this.shared&&!l.key.startsWith(this.shared)||(this._files.push(l),this._files.sort(this.sorter),this.addTreeNode(l))}}catch(s){a=!0,r=s}finally{try{n||null==o.return||o.return()}finally{if(a)throw r}}}},{key:"trimTree",value:function(){for(var e=this.shared.replace(/^\/|\/$/g,"").split("/"),t=this.bucketRoot.children,n=function(){var n=e.shift(),a=t.find(function(e){return e.name===n});if(!a)return"break";t=a.children};e.length>0;){if("break"===n())break}this.bucketRoot.children=t}},{key:"getContentes",value:function(){var e=this.fetchBucketData();for(console.log("Data",e),this.bucketName=this.getNodeValue("Name",e),this.bucketRoot.name=this.bucketName,this.getFilesFromXML(e);"true"===this.getNodeValue("IsTruncated",e);){var t=this.getNodeValue("NextMarker",e);e=this.fetchBucketData(t),this.getFilesFromXML(e)}this.shared&&this.trimTree()}}]),e}(),v=n(61),w=n(25),g=n(312),E=n(9),O=n(309),x=n(308),S=n(311),j=n(310),z=n(307),N=n(58),C=n.n(N),B=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(d.a)(this,Object(f.a)(t).call(this,e))).state={bucket:{},seraching:!1,tree:[],files:[],data:[]},n.onRowClick=function(e,t,n){console.log("Row click",{record:e,index:t,event:n})},n.columns=[{title:"Name",dataIndex:"name",key:"name",width:"50%",render:function(e,t,a){return n.state.searching?r.a.createElement("div",{style:{marginLeft:"5px",display:"block"}},r.a.createElement("span",null,e),r.a.createElement("br",null),r.a.createElement("span",{style:{fontSize:"10px"}},t.key.substr(0,t.key.lastIndexOf("/")))):r.a.createElement("span",{style:{marginLeft:"5px"}},e)}},{title:"Actions",key:"actions",width:"10%",render:function(e,t,a){var i=r.a.createElement(v.a,{title:"Download this ".concat(t.type,": ").concat(t.name)},r.a.createElement(w.a,{icon:"download",shape:"round",onClick:n.handleDownload.bind(null,t)}));return r.a.createElement(w.a.Group,{size:"small"},r.a.createElement(v.a,{title:"Share this ".concat(t.type,": ").concat(t.name)},r.a.createElement(w.a,{icon:"link",shape:"round",onClick:n.handleShare.bind(null,t)})),"file"===t.type?i:"")}},{title:"Last Modified",dataIndex:"modified",key:"modified",width:"20%",render:function(e,t,n){return e?r.a.createElement("div",null,r.a.createElement(g.a,null,C()(e).fromNow()),r.a.createElement("br",null),r.a.createElement("small",null,e)):""}},{title:"Size",dataIndex:"size",key:"size",width:"20%",render:function(e,t,a){var i;if(e){var o="file"===t.type?"geekblue":"";i=r.a.createElement(g.a,{color:o,size:"small"},n.readableFileSize(e))}else i=r.a.createElement("span",null);return i}}],n}return Object(p.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=new b;this.setState({bucket:e,tree:e.tree,files:e.files,data:e.tree})}},{key:"readableFileSize",value:function(e){if(0===e)return"0.00 B";var t=Math.floor(Math.log(e)/Math.log(1024));return 1*(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}},{key:"fileIcon",value:function(e){var t;switch(e){case"pdf":t="file-pdf";break;case"tar":case"zip":case"gz":t="file-zip";break;case"png":case"jpg":case"jpge":case"tiff":case"bmp":t="file-image";break;default:t="file-text"}return t}},{key:"folderExpandIcon",value:function(e){var t,n="";return"file"===e.record.type?t=this.fileIcon(e.record.extension):e.expanded?(t="folder-open",n="filled"):(t="folder",n="filled"),r.a.createElement(E.a,{type:t,style:{fontSize:"18px"},theme:n})}},{key:"handleShare",value:function(e,t){O.a.info({title:"Share this ".concat(e.type," with others"),content:r.a.createElement("div",null,r.a.createElement("span",null,"Copy the following link:"),r.a.createElement(x.a.Paragraph,{code:!0,copyable:{text:e.share,onCopy:function(e){return S.a.success("Link copied!")}}},e.share))}),t.stopPropagation()}},{key:"handleDownload",value:function(e,t){window.open(e.url),t.preventDefault()}},{key:"handleSearch",value:function(){var e=Object(s.a)(l.a.mark(function e(t){var n,a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=[],(a=t.target.value.toLowerCase())&&a.length>=3?(this.setState({searching:!0}),n=this.state.files.filter(function(e){return e.name.toLowerCase().includes(a)})):(this.setState({searching:!1}),n=this.state.tree),this.setState({data:n});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(x.a.Title,{level:3},"Browsing: ",this.state.bucket.name,"/",this.state.bucket.shared),r.a.createElement(v.a,{title:"Search for file. Input at least 3 characaters."},r.a.createElement(j.a,{prefix:r.a.createElement(E.a,{type:"file-search"}),placeholder:"Search...",onChange:this.handleSearch.bind(this)})),r.a.createElement(z.a,{size:"medium",pagination:!1,expandIcon:this.folderExpandIcon.bind(this),columns:this.columns,dataSource:this.state.data,onRow:function(t,n){return{onClick:e.onRowClick.bind(null,t,n)}},expandRowByClick:!0}))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var D=document.querySelectorAll("div.mount-s3-tree");o.a.render(r.a.createElement(B,null),D[0]),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[156,1,2]]]);
//# sourceMappingURL=main.980d19cd.chunk.js.map